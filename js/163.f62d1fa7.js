"use strict";(self["webpackChunkto_vue"]=self["webpackChunkto_vue"]||[]).push([[163],{9163:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var i=function(){var e=this,t=e._self._c;return t("custom-modal",{attrs:{width:764,cross:!0,modalName:"isFilterModalOpened"}},[[t("div",{staticClass:"modal__container"},[t("div",{staticClass:"btns-group"},e._l(e.baseFilters,(function(s){return t("base-btn",{key:s.id,class:e.currentBaseFilter.sysName===s.sysName?"current-btn":"btn-group",attrs:{icon:s.icon,text:e.$t(s.name)},nativeOn:{click:function(t){return e.setCurrentFilter(s)}}})})),1),t("div",{staticClass:"modal__all-select"},[t("base-btn",{attrs:{icon:"folder"},nativeOn:{click:function(t){return t.stopPropagation(),e.openPresets("modal")}}}),t("base-btn",{class:"select-all-btn",attrs:{text:e.$t(e.textBtn)},nativeOn:{click:function(t){return t.preventDefault(),e.selectAll.apply(null,arguments)}}}),t("base-btn",{staticClass:"select-all-btn-arrow",attrs:{icon:"arrow"},nativeOn:{click:function(t){return t.stopPropagation(),e.openPresets("list")}}}),e.isPresetModalOpened?t("preset-modal",{on:{"close-preset":function(t){e.isPresetModalOpened=t}}}):e._e(),e.isPresetsListOpened?t("presets-list",{on:{"close-preset":function(t){e.isPresetsListOpened=t},"update-options":function(t){return e.updateFromPreset(t)}}}):e._e()],1),t("div",{staticClass:"modal__select"},[t("v-select",{staticClass:"modal__filters-options",attrs:{options:e.optionsForFilters,"close-on-select":!1,multiple:"",label:"name",placeholder:e.currentBaseFilter.filterName},on:{remove:e.removeSelectedOptionsItem},model:{value:e.selectedFilterOptions,callback:function(t){e.selectedFilterOptions=t},expression:"selectedFilterOptions"}})],1),t("div",{staticClass:"modal__checkboxes"},e._l(e.modalCheckboxes,(function(s,i){return t("label",{key:i,staticClass:"checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedCheckboxes,expression:"selectedCheckboxes"}],staticClass:"checkbox__input",attrs:{type:"checkbox"},domProps:{value:i,checked:Array.isArray(e.selectedCheckboxes)?e._i(e.selectedCheckboxes,i)>-1:e.selectedCheckboxes},on:{change:function(t){var s=e.selectedCheckboxes,r=t.target,l=!!r.checked;if(Array.isArray(s)){var n=i,o=e._i(s,n);r.checked?o<0&&(e.selectedCheckboxes=s.concat([n])):o>-1&&(e.selectedCheckboxes=s.slice(0,o).concat(s.slice(o+1)))}else e.selectedCheckboxes=l}}}),t("span",[e._v(e._s(e.$t(s)))])])})),0),t("base-btn",{class:"apply-btn",attrs:{text:e.$t("Применить"),disabled:!e.selectedFilterOptions.length},nativeOn:{click:function(t){return e.execute.apply(null,arguments)}}})],1)]],2)},r=[],l=s(5770),n=s(408),o=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside.self",value:e.closePresets,expression:"closePresets",modifiers:{self:!0}}],staticClass:"presets"},[t("div",[t("ul",{staticClass:"presets__list"},e._l(e.filteredPresets,(function(s){return t("li",{key:s.id,staticClass:"presets__item"},[t("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.setPreset(s)}}},[e._v(e._s(s.name))]),t("span",{staticClass:"cross",domProps:{innerHTML:e._s(e.cross)},on:{click:function(t){return e.deletePreset(s.id)}}})])})),0)])])},c=[],a=s(9482),d={name:"PresetsList",data(){return{cross:a.kC}},watch:{filteredPresets:{handler(e){e.length||this.$emit("close-preset",!1)},deep:!0}},computed:{...(0,n.Se)("appoint",["filteredPresets"]),...(0,n.rn)({currentFilter:e=>e.currentFilter})},methods:{...(0,n.OI)(["updatePayload"]),deletePreset(e){this.$store.commit("appoint/filterPreset",e)},closePresets(e){e.target.classList.contains("presets")||this.$emit("close-preset",!1)},setPreset(e){let t=e.items.map((e=>+e));this.$emit("update-options",t)}}},p=d,u=s(1001),h=(0,u.Z)(p,o,c,!1,null,"5aa6e48c",null),m=h.exports,F=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside.self",value:e.closePresets,expression:"closePresets",modifiers:{self:!0}}],staticClass:"presets"},[t("div",{staticClass:"add-preset"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],ref:"presetRef",attrs:{type:"text"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e.notSelectedOptions?t("span",{staticClass:"backError preset-error"},[e._v("Выберите опции")]):e._e(),t("base-btn",{staticClass:"apply-btn",attrs:{text:"Сохранить набор"},nativeOn:{click:function(t){return e.createPreset.apply(null,arguments)}}})],1)])},O=[],b={name:"Preset",data(){return{name:"",notSelectedOptions:!1}},mounted(){this.$nextTick((()=>{this.$refs.presetRef.focus()}))},computed:{...(0,n.rn)({selectedFilterOptionsVuex:e=>e.selectedFilterOptionsVuex,currentFilter:e=>e.currentFilter})},watch:{selectedFilterOptionsVuex:{handler(e){e.length&&(this.notSelectedOptions=!1)},deep:!0}},methods:{...(0,n.OI)(["addPreset"]),closePresets(e){e.target.classList.contains("presets")||this.$emit("close-preset",!1)},async createPreset(){if(!this.selectedFilterOptionsVuex.length)return void(this.notSelectedOptions=!0);const e="cabinet"===this.currentFilter.sysName?"byCabinets":"spec"===this.currentFilter.sysName?"byResource":"byDates";let t={name:this.name,items:this.selectedFilterOptionsVuex.map((e=>e.id)),view_name:e};this.$store.commit("appoint/addPreset",t),this.$emit("close-preset",!1)}}},f=b,x=(0,u.Z)(f,F,O,!1,null,"7317813d",null),P=x.exports,v={name:"FiltersModal",data(){return{modalCheckboxes:l.DP,baseFilters:l.Tk,currentBaseFilter:"",selectedFilterForCabinet:[],selectedFilterForSpec:[],selectedCheckboxes:[],isAllOptionsSelected:!1,isPresetModalOpened:!1,isPresetsListOpened:!1}},components:{"preset-modal":P,"presets-list":m},mounted(){this.selectedCheckboxes=this.selectedCheckboxesVuex,this.currentBaseFilter={...this.currentFilter},this.selectedFilterOptions=this.selectedFilterOptionsVuex},computed:{...(0,n.rn)({cabinets:e=>e.cabinets,doctors:e=>e.specs,currentFilter:e=>e.currentFilter,selectedFilterOptionsVuex:e=>e.selectedFilterOptionsVuex,selectedCheckboxesVuex:e=>e.selectedCheckboxes}),...(0,n.Se)("appoint",["filteredPresets"]),doctorsOptionsForSelect:{get(){return this.doctors},set(e){return e}},cabinetsOptionsForSelect:{get(){return[...this.cabinets]},set(e){return e}},optionsForFilters:{get(){let e=[];return e="cabinet"!==this.currentBaseFilter.sysName?this.doctorsOptionsForSelect.filter((e=>!this.selectedFilterOptions.includes(e))):this.cabinetsOptionsForSelect.filter((e=>!this.selectedFilterOptions.includes(e))),e},set(e){return"cabinet"!==this.currentBaseFilter.sysName?this.doctorsOptionsForSelect=e:this.cabinetsOptionsForSelect=e}},selectedFilterOptions:{get(){return"cabinet"!==this.currentBaseFilter.sysName?this.selectedFilterForSpec:this.selectedFilterForCabinet},set(e){"cabinet"!==this.currentBaseFilter.sysName?this.selectedFilterForSpec=e:this.selectedFilterForCabinet=e}},textBtn(){return this.isAllOptionsSelected&&!this.optionsForFilters.length?"Очистить все":"Выбрать все"}},watch:{currentFilter(e){this.currentBaseFilter=this.currentFilter},currentBaseFilter(e){"cabinet"===e.sysName&&this.isAllOptionsSelected&&(this.selectedFilterOptions=this.cabinets),"cabinet"!==e.sysName&&this.isAllOptionsSelected&&(this.selectedFilterOptions=this.doctors)},isAllOptionsSelected(e){e&&("cabinet"===this.currentBaseFilter.sysName?this.selectedFilterOptions=this.cabinets:(this.selectedFilterOptions=this.doctors,this.doctorsOptionsForSelect=[]),this.optionsForFilters=[]),e||("cabinet"===this.currentBaseFilter.sysName?this.selectedFilterOptions.length===this.cabinetsOptionsForSelect.length&&(this.selectedFilterOptions=[]):this.selectedFilterOptions.length===this.doctorsOptionsForSelect.length&&(this.selectedFilterOptions=[]))},optionsForFilters:{handler(e){e.length?this.isAllOptionsSelected=!1:this.isAllOptionsSelected=!0},deep:!0},selectedFilterOptions:{handler(e){this.$store.commit("updatePayload",{option:"selectedFilterOptionsVuex",payload:e})},deep:!0}},methods:{...(0,n.nv)("appoint",["getData"]),...(0,n.OI)(["updatePayload"]),...(0,n.OI)("modal",["closeModal"]),selectAll(e){e.stopPropagation(),this.isAllOptionsSelected=!this.isAllOptionsSelected},async execute(){this.$store.commit("updatePayload",{option:"currentFilter",payload:this.currentBaseFilter}),this.$store.commit("updatePayload",{option:"selectedCheckboxes",payload:this.selectedCheckboxes}),await this.$store.dispatch("appoint/getData"),this.$store.commit("modal/closeModal","isFilterModalOpened")},setCurrentFilter(e){this.currentBaseFilter=e},removeSelectedOptionsItem(e){this.selectedFilterForSpec=this.selectedFilterOptions.filter((t=>t.id!==e.id))},openPresets(e){"modal"===e&&(this.isPresetModalOpened=!0,this.isPresetsListOpened=!1),"list"===e&&(this.filteredPresets.length&&(this.isPresetsListOpened=!0),this.isPresetModalOpened=!1)},updateFromPreset(e){let t=[...this.optionsForFilters.filter((t=>e.includes(t.id)))];t.length&&this.$store.commit("updatePayload",{option:"selectedFilterOptionsVuex",payload:t}),this.isPresetsListOpened=!1,this.execute()},closeModal(){this.$store.commit("modal/closeModal","isFilterModalOpened")}}},k=v,C=(0,u.Z)(k,i,r,!1,null,"cf559fce",null),y=C.exports}}]);
//# sourceMappingURL=163.f62d1fa7.js.map